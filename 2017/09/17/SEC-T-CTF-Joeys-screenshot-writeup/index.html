<!doctype html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css" integrity="sha384-cg6SkqEOCV1NbJoCu11+bm0NvBRc8IYLRGXkmNrqUBfTjmMYwNKPWBTIKyw9mHNJ" crossorigin="anonymous">
  <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/grids-responsive-min.css">
  <link rel="stylesheet" href="/assets/styles.css"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>[SEC-T CTF]Joeys screenshot writeup | elephacking</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="[SEC-T CTF]Joeys screenshot writeup" />
<meta name="author" content="Elephacking" />
<meta property="og:locale" content="en" />
<meta name="description" content="Question:" />
<meta property="og:description" content="Question:" />
<link rel="canonical" href="https://blog.hitlab.space/2017/09/17/SEC-T-CTF-Joeys-screenshot-writeup/" />
<meta property="og:url" content="https://blog.hitlab.space/2017/09/17/SEC-T-CTF-Joeys-screenshot-writeup/" />
<meta property="og:site_name" content="elephacking" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-09-17T00:00:00+08:00" />
<meta name="google-site-verification" content="ObzeHGhGdxnebH1Gi9Js56WL_lUIqTJmWmFuFM2scLk" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"https://blog.hitlab.space/2017/09/17/SEC-T-CTF-Joeys-screenshot-writeup/","headline":"[SEC-T CTF]Joeys screenshot writeup","dateModified":"2017-09-17T00:00:00+08:00","datePublished":"2017-09-17T00:00:00+08:00","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://blog.hitlab.space/assets/icons/favicon.ico"},"name":"Elephacking"},"author":{"@type":"Person","name":"Elephacking"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.hitlab.space/2017/09/17/SEC-T-CTF-Joeys-screenshot-writeup/"},"description":"Question:","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link type="application/atom+xml" rel="alternate" href="https://blog.hitlab.space/feed.xml" title="elephacking" />
</head>


  <body>

    <div class="container pure-g"><div class="sidebar-left pure-u-1 pure-u-md-1-4" style="background-color: rgb(40, 73, 77); color: rgb(255, 255, 255); background-image: url(/assets/img/sidebar-bg.jpg);"><header class="masthead">
  <div class="avatar"><img src="/assets/icons/logo.png" class="avatar-image" alt="Elephacking">
    </div>
  <div class="masthead-title">
    <a href="/" title="Home">elephacking</a>
  </div>
  <div class="masthead-tagline">
    <small>A Slave, a Security Fans, a Pentester, a Red Teamer - 隨便寫寫Cyber Security，在大學學到的東西和工作學到的東西 - I am moving my posts from the old blog to jekyll... -</small>
  </div><nav class="navigation">
    <ul class="navigation-list"><li class="navigation-item">
        <a onclick="sessionStorage.setItem('forceCheckScroll', 'true')" href="/">Blog</a>
      </li><li class="navigation-item">
        <a onclick="sessionStorage.setItem('forceCheckScroll', 'true')" href="/about/">About</a>
      </li></ul>
  </nav><div class="social pure-menu pure-menu-horizontal">
      <ul class="social-icons pure-menu-list">
      <li class="pure-menu-item">
          <a class="social-icon pure-menu-link" href="mailto://elephacking@gmail.com">
            <i class="fas fa-envelope" title="Email"></i>
          </a>
        </li><li class="pure-menu-item">
          <a class="social-icon pure-menu-link" href="https://github.com/elephacking">
            <i class="fab fa-github" title="GitHub"></i>
          </a>
        </li>
      </ul>
    </div>
</header>
</div>

      <div class="content pure-u-1 pure-u-md-1-2"><main>
  <article class="post">
  <h1 class="post-title">[SEC-T CTF]Joeys screenshot writeup</h1>
  <div class="post-meta"><time datetime="2017-09-17T00:00:00+08:00" itemprop="datePublished">17 Sep 2017</time></div>

  <p>Question:</p>

<h1 id="joeys-screenshot--misc-50--0">Joeys screenshot – Misc (50 + 0)</h1>
<p>Joey gave me this screenshot to prove he got into The Gibson. Can you help us hack The Gibson too?</p>

<p>Solves: 69</p>

<p>Download: <a href="http://dl.ctf.rocks/joey.tar.gz" title="http://dl.ctf.rocks/joey.tar.gz">http://dl.ctf.rocks/joey.tar.gz</a></p>

<p>Author: SecureLink / klondike</p>

<p>The is an easy challenge but killed my brain cells.</p>

<p>binwalk is your friend</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 1131 x 481, 8-bit/color RGB, non-interlaced
70            0x46            Zlib compressed data, default compression
122           0x7A            Zlib compressed data, default compression
174           0xAE            Zlib compressed data, default compression
225           0xE1            Zlib compressed data, default compression
277           0x115           Zlib compressed data, default compression
329           0x149           Zlib compressed data, default compression
381           0x17D           Zlib compressed data, default compression
433           0x1B1           Zlib compressed data, default compression
484           0x1E4           Zlib compressed data, default compression
536           0x218           Zlib compressed data, default compression
588           0x24C           Zlib compressed data, default compression
640           0x280           Zlib compressed data, default compression
692           0x2B4           Zlib compressed data, default compression
743           0x2E7           Zlib compressed data, default compression
795           0x31B           Zlib compressed data, default compression
847           0x34F           Zlib compressed data, default compression
899           0x383           Zlib compressed data, default compression
951           0x3B7           Zlib compressed data, default compression
1003          0x3EB           Zlib compressed data, default compression
1055          0x41F           Zlib compressed data, default compression
1107          0x453           Zlib compressed data, default compression
1159          0x487           Zlib compressed data, default compression
1211          0x4BB           Zlib compressed data, default compression
1262          0x4EE           Zlib compressed data, default compression
1314          0x522           Zlib compressed data, default compression
1365          0x555           Zlib compressed data, default compression
1417          0x589           Zlib compressed data, default compression
1469          0x5BD           Zlib compressed data, default compression
1521          0x5F1           Zlib compressed data, default compression
1573          0x625           Zlib compressed data, default compression
1625          0x659           Zlib compressed data, default compression
1677          0x68D           Zlib compressed data, default compression
1728          0x6C0           Zlib compressed data, default compression
1780          0x6F4           Zlib compressed data, default compression
1832          0x728           Zlib compressed data, default compression
1884          0x75C           Zlib compressed data, default compression
1935          0x78F           Zlib compressed data, default compression
1987          0x7C3           Zlib compressed data, default compression
2039          0x7F7           Zlib compressed data, default compression
2091          0x82B           Zlib compressed data, default compression
2143          0x85F           Zlib compressed data, default compression
2194          0x892           Zlib compressed data, default compression
2246          0x8C6           Zlib compressed data, default compression
2298          0x8FA           Zlib compressed data, default compression
2349          0x92D           Zlib compressed data, default compression
2401          0x961           Zlib compressed data, default compression
2453          0x995           Zlib compressed data, default compression
2475          0x9AB           Zlib compressed data, default compression
 
</code></pre></div></div>

<p>You can do it easily by using -e option of binwalk. Or write a python code to decode the iTXt section of the PNG format.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pngcheck <span class="nt">-v</span> chall.png | <span class="nb">grep </span>iTXt | <span class="nb">cut</span> <span class="nt">-d</span> ‘ ‘ <span class="nt">-f</span> 7,9 <span class="o">&gt;</span> address.txt
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">zlib</span>
<span class="n">raw</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'chall.png'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s">'address.txt'</span><span class="p">):</span>
	<span class="n">data</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)</span>
	<span class="n">address</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">16</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
	<span class="n">leet</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="n">address</span><span class="p">:</span><span class="n">address</span><span class="o">+</span><span class="n">length</span><span class="o">+</span><span class="mi">10</span><span class="p">]</span> <span class="c1">#length + 10 bytes is the real length of the data
</span>	<span class="n">leet_data</span> <span class="o">=</span> <span class="n">leet</span><span class="p">[</span><span class="n">leet</span><span class="p">.</span><span class="n">rfind</span><span class="p">(</span><span class="s">b'x</span><span class="se">\x9c</span><span class="s">'</span><span class="p">):]</span>
	<span class="n">d</span> <span class="o">=</span> <span class="n">zlib</span><span class="p">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">leet_data</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]).</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>
	<span class="k">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
	<span class="n">k</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
	<span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
	<span class="n">a</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
	<span class="k">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="s">' '</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>

<span class="n">b</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">keys</span><span class="p">()):</span>
	<span class="n">b</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</code></pre></div></div>
<p>flag: SECT{D4_K3Y_2_D4_G1B50N_5UP3RU53R_15_G0D_H3H3!}</p>


  
</article>


<aside class="related">
  <h3>Related posts</h3>
  <ul class="related-posts">
    
      <li>
        <a href="/2017/09/17/SEC-T-CTF-Jail-writeup/">
          [SEC-T CTF]Jail writeup
          <small><time datetime="2017-09-17T00:00:00+08:00">17 Sep 2017</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2017/09/17/SEC-T-CTF-Jail-2-writeup/">
          [SEC-T CTF]Jail 2 writeup
          <small><time datetime="2017-09-17T00:00:00+08:00">17 Sep 2017</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2017/09/17/SEC-T-CTF-Black-&-White-Writeup/">
          [SEC-T CTF]Black & White Writeup
          <small><time datetime="2017-09-17T00:00:00+08:00">17 Sep 2017</time></small>
        </a>
      </li>
    
  </ul>
</aside>


</main>

<footer class="footer"><small>
    &copy; 2017&nbsp;-&nbsp;2021 <a href="https://github.com/elephacking">Elephacking</a>. All rights reserved.
    Powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://github.com/vszhub/not-pure-poole">Not Pure Poole</a>.
  </small>
</footer>
</div>
      <div class="sidebar-right pure-u-1 pure-u-md-1-4">
</div>
    </div>

    <script async src="https://use.fontawesome.com/releases/v5.0.12/js/all.js"></script><script>
  function strip(str, remove) {
    while (str.length > 0 && remove.indexOf(str.charAt(0)) != -1) {
      str = str.substr(1);
    }
    while (str.length > 0 && remove.indexOf(str.charAt(str.length - 1)) != -1) {
      str = str.substr(0, str.length - 1);
    }
    return str;
  }

  function scroll() {
    console.log('scroll');
    window.scrollTo({
      left: 0, 
      top: window.innerHeight,
      behavior: 'smooth'
    });
    sessionStorage.removeItem('forceCheckScroll');
  }

  const forceCheckScroll = sessionStorage.getItem('forceCheckScroll') === 'true';
  const checkScroll = strip(window.location.pathname, '/') !== strip('', '/');

  if (forceCheckScroll || checkScroll) {
    const maxWidth = "(max-width: 48rem)";
    const result = window.matchMedia(maxWidth);
    if (result.matches) {
      scroll();
    } else {
      result.addListener((match) => {
        if (match.media == maxWidth) {
          if (match.matches) {
            scroll();
          }
        }
      });
    }
  }
</script>
</body>
</html>
